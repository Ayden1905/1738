{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data":{ "url":"cafes-and-restaurants-with-seating-capacity.csv"},
    "background":"rgba(255,255,255,0.8)",
    "title":"% of seating of total seating in suburbs",
    "width":"container",
    "transform": [
        {"filter":"datum.percentage > 3"},
        {"aggregate": 
        [{"op":"count", "as":"cafe_count"}],
        "groupby": ["clue_small_area"]
    },
    {
        "window": [{"op":"sum","field": "cafe_count","as": "total_cafes"}],
        "frame": [null,null]
    },
    {
        "calculate": "datum.cafe_count/datum.total_cafes*100", "as": "percentage"
    }
    ],
    "layer":[{
    "mark": "arc",
    "encoding":{
        "theta":{
            "field":"percentage",
            "type": "quantitative",
            "stack":true},
    "color":{
            "field":"clue_small_area",
            "type":"nominal",
            "title":"Suburbs in Victoria",
            "scale":{
                "range": [
                    "#006BA4",
                    "#FF800E",
                    "#ABABAB",
                    "#595959",
                    "#5F9ED1",
                    "#C85200",
                    "#898989",
                    "#A2C8EC",
                    "#FFBC79",
                    "#CFCFCF"
                ]
                
    }
    },
    "tooltip": [
    {"field":"clue_small_area","title":"Suburb"},
    {"field":"percentage","title":"Percentage(%)"},
    {"field":"cafe_count","title":"Number of Cafes"}
    ]
}
},
{
    "mark":{"type":"text","radius":110,"fill":"black"},
    "encoding": {
        "theta":{"field":"percentage","type": "quantitative","stack":true},
        "text":{"field":"percentage","type": "quantitative","format":".1f"}
    }
}
],
"config": {}

}









